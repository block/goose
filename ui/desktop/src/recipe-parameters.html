<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recipe Parameters</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background-color: #1e1e1e;
      color: #ffffff;
      padding: 20px;
      margin: 0;
    }
    h1 {
      margin-top: 0;
      font-size: 1.5rem;
    }
    .recipe-description {
      margin-bottom: 20px;
      color: #cccccc;
    }
    .param-form {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .param-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    label {
      font-weight: 500;
    }
    .required {
      color: #ff6b6b;
      margin-left: 4px;
    }
    input, textarea, select {
      background-color: #2d2d2d;
      border: 1px solid #444444;
      color: #ffffff;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 0.9rem;
    }
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #0078d7;
    }
    .actions {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      margin-top: 20px;
    }
    button {
      padding: 8px 16px;
      background-color: #2d2d2d;
      border: 1px solid #444444;
      color: #ffffff;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    button.primary {
      background-color: #0078d7;
      border-color: #0078d7;
    }
    button:hover {
      background-color: #3d3d3d;
    }
    button.primary:hover {
      background-color: #0086f0;
    }
  </style>
</head>
<body>
  <h1 id="recipe-title">Recipe Parameters</h1>
  <p id="recipe-description" class="recipe-description"></p>
  
  <form id="param-form" class="param-form">
    <div id="params-container">
      <!-- Parameters will be dynamically added here -->
    </div>
    
    <div class="actions">
      <button type="button" id="cancel-btn">Cancel</button>
      <button type="submit" id="submit-btn" class="primary">Start Session</button>
    </div>
  </form>

  <script>
    // Receive the recipe config from the main process
    window.api.receive('load-recipe-parameters', (recipeConfig) => {
      document.getElementById('recipe-title').textContent = recipeConfig.title || 'Recipe Parameters';
      document.getElementById('recipe-description').textContent = recipeConfig.description || '';
      
      const paramsContainer = document.getElementById('params-container');
      
      // Clear any existing parameters
      paramsContainer.innerHTML = '';
      
      // Add form fields for each parameter
      if (recipeConfig.parameters && recipeConfig.parameters.length > 0) {
        recipeConfig.parameters.forEach(param => {
          const paramGroup = document.createElement('div');
          paramGroup.className = 'param-group';
          
          const label = document.createElement('label');
          label.htmlFor = `param-${param.key}`;
          label.textContent = param.description || param.key;
          
          if (param.requirement === 'required') {
            const requiredMark = document.createElement('span');
            requiredMark.className = 'required';
            requiredMark.textContent = '*';
            label.appendChild(requiredMark);
          }
          
          paramGroup.appendChild(label);
          
          let input;
          
          switch (param.input_type) {
            case 'boolean':
              input = document.createElement('select');
              
              const trueOption = document.createElement('option');
              trueOption.value = 'true';
              trueOption.textContent = 'Yes';
              
              const falseOption = document.createElement('option');
              falseOption.value = 'false';
              falseOption.textContent = 'No';
              
              input.appendChild(trueOption);
              input.appendChild(falseOption);
              
              if (param.default === 'true') {
                trueOption.selected = true;
              } else {
                falseOption.selected = true;
              }
              break;
              
            case 'number':
              input = document.createElement('input');
              input.type = 'number';
              input.value = param.default || '';
              break;
              
            case 'date':
              input = document.createElement('input');
              input.type = 'date';
              input.value = param.default || '';
              break;
              
            case 'file':
              // Note: File inputs will need special handling
              input = document.createElement('input');
              input.type = 'text';
              input.value = param.default || '';
              input.placeholder = 'Enter file path';
              break;
              
            default: // string
              input = document.createElement('input');
              input.type = 'text';
              input.value = param.default || '';
          }
          
          input.id = `param-${param.key}`;
          input.name = param.key;
          input.required = param.requirement === 'required';
          
          paramGroup.appendChild(input);
          paramsContainer.appendChild(paramGroup);
        });
      } else {
        const noParamsMessage = document.createElement('p');
        noParamsMessage.textContent = 'This recipe has no parameters.';
        paramsContainer.appendChild(noParamsMessage);
      }
      
      // Set up form submission handler
      document.getElementById('param-form').addEventListener('submit', (e) => {
        e.preventDefault();
        
        const paramValues = {};
        recipeConfig.parameters.forEach(param => {
          const input = document.getElementById(`param-${param.key}`);
          paramValues[param.key] = input.value;
        });
        
        // Send the parameter values back to the main process
        window.api.send('recipe-parameters-submitted', {
          recipeConfig,
          paramValues
        });
      });
      
      // Set up cancel button
      document.getElementById('cancel-btn').addEventListener('click', () => {
        window.api.send('recipe-parameters-cancelled');
      });
    });
  </script>
</body>
</html> 