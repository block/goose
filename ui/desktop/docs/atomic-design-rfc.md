# Atomic Design migration (ui/desktop)

## Why
The current `ui/desktop/src/components` tree mixes multiple organizing principles at once (feature folders, UI kit layers, layout, pages). This makes it hard to:

- reason about reuse boundaries
- find the right building block quickly
- prevent “page-level” components from creeping into the design system

Goal: converge on **one primary hierarchy** based on Brad Frost’s Atomic Design: **Atoms → Molecules → Organisms → Templates → Pages**.

Source: https://atomicdesign.bradfrost.com/chapter-2/

## Atomic Design definitions (Chapter 2, adapted to this codebase)

- **Atoms**: smallest functional UI building blocks.
  - Examples: `Button`, `Input`, `Badge`, `Icon`, `Separator`
- **Molecules**: small groups of atoms working together as a unit.
  - Examples: `Card`, `DropdownMenu`, `Modal` shell, `DataTable`, `TabBar`
- **Organisms**: feature-level sections composed of molecules.
  - Examples: `GooseSidebar`, `InstanceList`, `EvalRunner`, `Settings` panels
- **Templates**: layout scaffolding defining page regions.
  - Examples: `AppLayout`, `MainPanelLayout`, `PageShell` (if it’s mostly structure)
- **Pages**: route-level screens, concrete instances of Templates.
  - Examples: `WelcomePage`, `LauncherView`, `AgentsView` (if it’s the routed screen)

## Target directory structure

All component implementations live under **exactly one** of:

```
ui/desktop/src/components/
  atoms/
  molecules/
  organisms/
  templates/
  pages/
```

Subfolders inside each layer are allowed (e.g. `atoms/forms`, `organisms/agents`).

### Transitional compatibility policy
To avoid huge churn, we can keep the old paths as **thin re-export barrels only** during a transition window.

Example:

- New canonical file: `src/components/molecules/Card/Card.tsx`
- Old file remains temporarily: `src/components/ui/molecules/card.tsx` exporting from the new path.

## Proposed mapping rules (first pass)

### Heuristics
- If it’s a primitive control or typographic/visual primitive → **Atoms**
- If it composes a few atoms into a reusable pattern → **Molecules**
- If it represents a full feature section (has data-fetching hooks, orchestration logic, complex state) → **Organisms**
- If it’s mostly layout slots/structure (header/sidebar/content regions) → **Templates**
- If it is routed or named like a screen/view → **Pages**

### Open questions for UX/UI/frontend review
1) Should `design-system/*` be entirely **Molecules**, or can some be **Atoms** (e.g. `StatusDot`)?
2) Is `PageShell` a **Template** or a **Molecule** (if it’s more of a reusable wrapper)?
3) Are feature "views" like `AgentsView` considered **Pages** (routed) or **Organisms** (embeddable)?
4) Do we want enforcement rules (Biome/ESLint) for cross-layer import boundaries?

## Current inventory

- Draft inventory + current classification lives in:
  - `ui/desktop/docs/atomic-design-inventory.md`
  - generated by `ui/desktop/scripts/generate-atomic-inventory.py`

## Migration plan (phased)

1) **Agree on rules + mapping** (this doc + team feedback)
2) **Move shared UI primitives first** (`components/ui/atoms/*` → `components/atoms/*`)
3) **Move reusable composites** (`components/ui/molecules/*` and `components/ui/design-system/*` → `components/molecules/*`)
4) **Move layout scaffolds** (`components/Layout/*` → `components/templates/*`)
5) **Move routed pages** (`components/pages/*` → `components/pages/*`)
6) **Move feature sections** (agents/analytics/chat/messages/settings/etc. → `components/organisms/<feature>/*`)
7) Remove legacy re-export barrels when imports are fully migrated.
