# Goose Enterprise Platform - Architecture Diagrams

## Document Control

| Attribute | Value |
|-----------|-------|
| **Version** | 1.0.0 |
| **Created** | 2026-02-03 |
| **Last Updated** | 2026-02-03 |

---

## 1. High-Level System Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         GOOSE ENTERPRISE PLATFORM                                │
│                                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────────┐   │
│  │                           CLIENT LAYER                                    │   │
│  │                                                                           │   │
│  │   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌────────────┐   │   │
│  │   │    CLI      │   │  Dashboard  │   │   REST API  │   │  WebSocket │   │   │
│  │   │  Interface  │   │    (Web)    │   │   Gateway   │   │  Streaming │   │   │
│  │   └──────┬──────┘   └──────┬──────┘   └──────┬──────┘   └─────┬──────┘   │   │
│  └──────────┼─────────────────┼─────────────────┼────────────────┼──────────┘   │
│             │                 │                 │                │              │
│             └─────────────────┴────────┬────────┴────────────────┘              │
│                                        │                                         │
│  ┌─────────────────────────────────────┼────────────────────────────────────┐   │
│  │                          SECURITY LAYER                                   │   │
│  │                                     │                                     │   │
│  │   ┌─────────────────────────────────┼─────────────────────────────────┐  │   │
│  │   │              GUARDRAILS ENGINE (Phase 1)                          │  │   │
│  │   │                                 │                                 │  │   │
│  │   │  ┌────────┐ ┌────────┐ ┌───────┴───┐ ┌────────┐ ┌────────┐       │  │   │
│  │   │  │  PII   │ │Injection│ │ Jailbreak │ │ Topic  │ │ Secret │       │  │   │
│  │   │  │Detector│ │Detector │ │ Detector  │ │Detector│ │Detector│       │  │   │
│  │   │  └────────┘ └────────┘ └───────────┘ └────────┘ └────────┘       │  │   │
│  │   └───────────────────────────────────────────────────────────────────┘  │   │
│  └──────────────────────────────────────┼───────────────────────────────────┘   │
│                                         │                                        │
│  ┌──────────────────────────────────────┼───────────────────────────────────┐   │
│  │                          CORE AGENT LAYER                                 │   │
│  │                                      │                                    │   │
│  │  ┌───────────────┐  ┌───────────────┼───────────────┐  ┌──────────────┐  │   │
│  │  │   Policies    │  │         Agent Core           │  │ Observability│  │   │
│  │  │   (Phase 4)   │──│                              │──│  (Phase 3)   │  │   │
│  │  │               │  │  ┌──────────────────────┐    │  │              │  │   │
│  │  │ • Rules       │  │  │   Reasoning Engine   │    │  │ • Costs      │  │   │
│  │  │ • Conditions  │  │  │  • Chain-of-Thought  │    │  │ • Metrics    │  │   │
│  │  │ • Actions     │  │  │  • Tree-of-Thought   │    │  │ • Traces     │  │   │
│  │  │ • YAML Config │  │  │  • Reflexion         │    │  │ • Export     │  │   │
│  │  └───────────────┘  │  └──────────────────────┘    │  └──────────────┘  │   │
│  │                     │                              │                    │   │
│  │                     │  ┌──────────────────────┐    │                    │   │
│  │                     │  │   Prompt Patterns    │    │                    │   │
│  │                     │  │     (Phase 5)        │    │                    │   │
│  │                     │  │  • 14 Patterns       │    │                    │   │
│  │                     │  │  • Templates         │    │                    │   │
│  │                     │  │  • Composition       │    │                    │   │
│  │                     │  └──────────────────────┘    │                    │   │
│  │                     └──────────────────────────────┘                    │   │
│  └──────────────────────────────────────┼───────────────────────────────────┘   │
│                                         │                                        │
│  ┌──────────────────────────────────────┼───────────────────────────────────┐   │
│  │                       MCP GATEWAY LAYER (Phase 2)                         │   │
│  │                                      │                                    │   │
│  │  ┌──────────────┐  ┌────────────────┴────────────────┐  ┌─────────────┐  │   │
│  │  │   Router     │  │        Tool Registry            │  │   Audit     │  │   │
│  │  │              │  │                                 │  │   Logger    │  │   │
│  │  │ • Discovery  │  │  ┌──────┐ ┌──────┐ ┌──────┐    │  │             │  │   │
│  │  │ • Load Bal.  │  │  │Tool 1│ │Tool 2│ │Tool N│    │  │ • Events    │  │   │
│  │  │ • Health     │  │  └──────┘ └──────┘ └──────┘    │  │ • Search    │  │   │
│  │  └──────────────┘  └─────────────────────────────────┘  └─────────────┘  │   │
│  │                                      │                                    │   │
│  │  ┌──────────────┐                    │                  ┌─────────────┐  │   │
│  │  │ Permissions  │                    │                  │ Credentials │  │   │
│  │  │              │                    │                  │             │  │   │
│  │  │ • RBAC       │                    │                  │ • Org-level │  │   │
│  │  │ • Allow List │                    │                  │ • User-level│  │   │
│  │  │ • Policies   │                    │                  │ • Session   │  │   │
│  │  └──────────────┘                    │                  └─────────────┘  │   │
│  └──────────────────────────────────────┼───────────────────────────────────┘   │
│                                         │                                        │
│  ┌──────────────────────────────────────┼───────────────────────────────────┐   │
│  │                       EXTERNAL SERVICES                                   │   │
│  │                                      │                                    │   │
│  │   ┌──────────┐  ┌──────────┐  ┌─────┴─────┐  ┌──────────┐  ┌──────────┐  │   │
│  │   │  Claude  │  │  OpenAI  │  │   MCP     │  │  Vector  │  │ Database │  │   │
│  │   │    API   │  │    API   │  │  Servers  │  │    DB    │  │          │  │   │
│  │   └──────────┘  └──────────┘  └───────────┘  └──────────┘  └──────────┘  │   │
│  └──────────────────────────────────────────────────────────────────────────┘   │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. Request Flow Diagram

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           REQUEST FLOW                                           │
└─────────────────────────────────────────────────────────────────────────────────┘

    User Input                                                          Response
        │                                                                   ▲
        ▼                                                                   │
┌───────────────┐                                                   ┌───────────────┐
│   CLI / API   │                                                   │   Response    │
│   Gateway     │                                                   │   Formatter   │
└───────┬───────┘                                                   └───────┬───────┘
        │                                                                   │
        ▼                                                                   │
┌───────────────────────────────────────────────────────────────────────────────┐
│                          GUARDRAILS (Phase 1)                                 │
│   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐           │
│   │  PII    │  │Injection│  │Jailbreak│  │ Topic   │  │ Secret  │           │
│   │ Check   │  │  Check  │  │  Check  │  │  Check  │  │  Check  │           │
│   └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘           │
│        └────────────┴───────────┬┴───────────┴────────────┘                 │
│                                 │                                            │
│                          ┌──────┴──────┐                                    │
│                          │   Passed?   │                                    │
│                          └──────┬──────┘                                    │
│                                 │                                            │
│                    ┌────────────┼────────────┐                              │
│                    │ Yes        │            │ No                           │
└────────────────────┼────────────┼────────────┼──────────────────────────────┘
                     │            │            │
                     ▼            │            ▼
              ┌──────────┐       │      ┌──────────┐
              │ Continue │       │      │  Block   │─────────────────────┐
              └────┬─────┘       │      │ Response │                     │
                   │             │      └──────────┘                     │
                   ▼             │                                       ▼
┌──────────────────────────────────────────────────────────┐    ┌────────────┐
│                   POLICY ENGINE (Phase 4)                 │    │  Return    │
│   ┌─────────────────────────────────────────────────┐    │    │ Blocked    │
│   │              Rule Evaluation                     │    │    │  Message   │
│   │  ┌─────────┐  ┌─────────┐  ┌─────────┐         │    │    └────────────┘
│   │  │Condition│  │Condition│  │Condition│         │    │
│   │  │  Check  │──│  Check  │──│  Check  │         │    │
│   │  └────┬────┘  └────┬────┘  └────┬────┘         │    │
│   │       └────────────┴───────────┘               │    │
│   └─────────────────────┬───────────────────────────┘    │
│                         │                                │
│                  ┌──────┴──────┐                        │
│                  │   Action    │                        │
│                  │  Required?  │                        │
│                  └──────┬──────┘                        │
│                         │                                │
│            ┌────────────┼────────────┐                  │
│            │            │            │                  │
│         ┌──┴──┐     ┌───┴───┐   ┌───┴───┐             │
│         │Allow│     │ Warn  │   │ Block │             │
│         └──┬──┘     └───┬───┘   └───┬───┘             │
└────────────┼────────────┼───────────┼─────────────────┘
             │            │           │
             ▼            ▼           │
┌─────────────────────────────────────┼─────────────────────────────────────────┐
│              AGENT CORE             │                                          │
│   ┌────────────────────────────┐   │                                          │
│   │     Reasoning Engine       │   │                                          │
│   │  ┌─────────────────────┐   │   │                                          │
│   │  │ Chain-of-Thought    │   │   │                                          │
│   │  │ Planning            │   │   │                                          │
│   │  │ Tool Selection      │   │   │                                          │
│   │  └──────────┬──────────┘   │   │                                          │
│   └─────────────┼──────────────┘   │                                          │
│                 │                   │                                          │
│                 ▼                   │                                          │
│   ┌────────────────────────────┐   │                                          │
│   │    Prompt Construction     │   │                                          │
│   │      (Phase 5)             │   │                                          │
│   │  ┌─────────────────────┐   │   │                                          │
│   │  │ Pattern Selection   │   │   │                                          │
│   │  │ Template Rendering  │   │   │                                          │
│   │  │ Context Assembly    │   │   │                                          │
│   │  └──────────┬──────────┘   │   │                                          │
│   └─────────────┼──────────────┘   │                                          │
│                 │                   │                                          │
└─────────────────┼───────────────────┼──────────────────────────────────────────┘
                  │                   │
                  ▼                   │
┌─────────────────────────────────────┼──────────────────────────────────────────┐
│           MCP GATEWAY (Phase 2)     │                                          │
│   ┌─────────────────────────────┐   │                                          │
│   │       Permission Check      │   │                                          │
│   │  ┌─────────────────────┐    │   │                                          │
│   │  │  User Permissions   │    │   │                                          │
│   │  │  Tool Allowlist     │    │   │                                          │
│   │  │  Rate Limits        │    │   │                                          │
│   │  └──────────┬──────────┘    │   │                                          │
│   └─────────────┼───────────────┘   │                                          │
│                 │                   │                                          │
│   ┌─────────────▼───────────────┐   │                                          │
│   │        Tool Routing         │   │                                          │
│   │  ┌────────┐ ┌────────┐     │   │                                          │
│   │  │Server 1│ │Server 2│ ... │   │                                          │
│   │  └────┬───┘ └────┬───┘     │   │                                          │
│   │       └──────────┘         │   │                                          │
│   └─────────────┬───────────────┘   │                                          │
│                 │                   │                                          │
│   ┌─────────────▼───────────────┐   │                                          │
│   │        Audit Logging        │◄──┘                                          │
│   │   (All actions logged)      │                                              │
│   └─────────────────────────────┘                                              │
└────────────────────────────────────────────────────────────────────────────────┘
                  │
                  ▼
┌────────────────────────────────────────────────────────────────────────────────┐
│                    OBSERVABILITY (Phase 3)                                      │
│   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│   │    Cost      │  │   Metrics    │  │    Trace     │  │    Export    │       │
│   │   Tracking   │  │  Collection  │  │   Recording  │  │   (OTLP)     │       │
│   └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘       │
└────────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. Guardrails Detection Flow

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    GUARDRAILS DETECTION PIPELINE                                 │
└─────────────────────────────────────────────────────────────────────────────────┘

                              ┌──────────────┐
                              │  Input Text  │
                              └──────┬───────┘
                                     │
                                     ▼
                    ┌────────────────────────────────┐
                    │      Parallel Detection        │
                    │        (Async Execution)       │
                    └────────────────┬───────────────┘
                                     │
        ┌────────────┬───────────────┼───────────────┬────────────┬────────────┐
        │            │               │               │            │            │
        ▼            ▼               ▼               ▼            ▼            ▼
┌───────────┐ ┌───────────┐ ┌───────────────┐ ┌───────────┐ ┌───────────┐ ┌────────┐
│  Prompt   │ │    PII    │ │   Jailbreak   │ │   Topic   │ │  Keyword  │ │ Secret │
│ Injection │ │  Detector │ │   Detector    │ │  Detector │ │  Detector │ │Detector│
│  Detector │ │           │ │               │ │           │ │           │ │        │
└─────┬─────┘ └─────┬─────┘ └───────┬───────┘ └─────┬─────┘ └─────┬─────┘ └───┬────┘
      │             │               │               │             │           │
      │  ┌──────────┴──────────┐    │    ┌─────────┴─────────┐   │           │
      │  │ 30+ Regex Patterns  │    │    │ 50+ Known Patterns│   │           │
      │  │ • System prompt     │    │    │ • DAN mode        │   │           │
      │  │ • Role hijacking    │    │    │ • Roleplay exploits│   │           │
      │  │ • Instruction inject│    │    │ • Character bypass│   │           │
      │  └─────────────────────┘    │    └───────────────────┘   │           │
      │             │               │               │             │           │
      │  ┌──────────┴──────────┐    │    ┌─────────┴─────────┐   │           │
      │  │ 7 PII Types         │    │    │ Topic Matching    │   │           │
      │  │ • Email, Phone      │    │    │ • Allowlist       │   │           │
      │  │ • SSN, CC           │    │    │ • Blocklist       │   │           │
      │  │ • IP, DOB           │    │    │ • TF-IDF scoring  │   │           │
      │  └─────────────────────┘    │    └───────────────────┘   │           │
      │             │               │               │             │           │
      │             │    ┌──────────┴──────────┐   │    ┌────────┴────────┐  │
      │             │    │ 10+ Secret Patterns │   │    │ Custom Keywords │  │
      │             │    │ • AWS keys          │   │    │ • Blocklist     │  │
      │             │    │ • API tokens        │   │    │ • Regex support │  │
      │             │    │ • Private keys      │   │    │ • Fuzzy match   │  │
      │             │    └─────────────────────┘   │    └─────────────────┘  │
      │             │               │               │             │           │
      ▼             ▼               ▼               ▼             ▼           ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          Detection Results Aggregation                           │
│                                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                     DetectionResult per Detector                         │   │
│   │   • detector_name: String                                               │   │
│   │   • detected: bool                                                      │   │
│   │   • confidence: f64 (0.0 - 1.0)                                         │   │
│   │   • evidence: Vec<String>                                               │   │
│   │   • metadata: HashMap<String, Value>                                    │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
└──────────────────────────────────────┬──────────────────────────────────────────┘
                                       │
                                       ▼
                    ┌──────────────────────────────────┐
                    │      GuardrailsResult            │
                    │  • passed: bool                  │
                    │  • results: Vec<DetectionResult> │
                    │  • execution_time_ms: u64        │
                    │  • blocked_reason: Option<String>│
                    └──────────────────────────────────┘
```

---

## 4. Policy Engine Flow

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        POLICY ENGINE (RULE EVALUATION)                           │
└─────────────────────────────────────────────────────────────────────────────────┘

                              ┌──────────────┐
                              │    Event     │
                              │   (Context)  │
                              └──────┬───────┘
                                     │
                                     ▼
                    ┌────────────────────────────────┐
                    │      Load Rule Sets            │
                    │     (YAML Configuration)       │
                    └────────────────┬───────────────┘
                                     │
        ┌────────────────────────────┼────────────────────────────┐
        │                            │                            │
        ▼                            ▼                            ▼
┌───────────────┐          ┌───────────────┐          ┌───────────────┐
│  RuleSet 1    │          │  RuleSet 2    │          │  RuleSet N    │
│  security.yaml│          │   cost.yaml   │          │  custom.yaml  │
└───────┬───────┘          └───────┬───────┘          └───────┬───────┘
        │                          │                          │
        └──────────────────────────┼──────────────────────────┘
                                   │
                                   ▼
                    ┌──────────────────────────────────┐
                    │       Rule Iteration             │
                    │   (Sorted by severity/priority)  │
                    └──────────────────┬───────────────┘
                                       │
                                       ▼
                    ┌──────────────────────────────────┐
                    │        Event Type Match?         │
                    │   rule.event_types.contains(     │
                    │     event.event_type)            │
                    └──────────────────┬───────────────┘
                                       │
                          ┌────────────┴────────────┐
                          │ No                      │ Yes
                          ▼                         ▼
                    ┌──────────┐     ┌─────────────────────────────┐
                    │   Skip   │     │    Condition Evaluation     │
                    │   Rule   │     │                             │
                    └──────────┘     │   ┌─────────────────────┐   │
                                     │   │  26 Condition Types │   │
                                     │   │                     │   │
                                     │   │  String:            │   │
                                     │   │  • Contains         │   │
                                     │   │  • Matches (regex)  │   │
                                     │   │  • Equals           │   │
                                     │   │  • StartsWith       │   │
                                     │   │  • EndsWith         │   │
                                     │   │                     │   │
                                     │   │  Numeric:           │   │
                                     │   │  • GreaterThan      │   │
                                     │   │  • LessThan         │   │
                                     │   │  • Between          │   │
                                     │   │                     │   │
                                     │   │  Collection:        │   │
                                     │   │  • InList           │   │
                                     │   │  • NotInList        │   │
                                     │   │  • HasKey           │   │
                                     │   │  • IsEmpty          │   │
                                     │   │                     │   │
                                     │   │  Temporal:          │   │
                                     │   │  • Before           │   │
                                     │   │  • After            │   │
                                     │   │  • WithinLast       │   │
                                     │   │                     │   │
                                     │   │  Logical:           │   │
                                     │   │  • And              │   │
                                     │   │  • Or               │   │
                                     │   │  • Not              │   │
                                     │   └─────────────────────┘   │
                                     └─────────────┬───────────────┘
                                                   │
                                      ┌────────────┴────────────┐
                                      │ No Match               │ Match
                                      ▼                         ▼
                                ┌──────────┐     ┌─────────────────────────────┐
                                │   Skip   │     │     Execute Actions         │
                                │   Rule   │     │                             │
                                └──────────┘     │   ┌─────────────────────┐   │
                                                 │   │   11 Action Types   │   │
                                                 │   │                     │   │
                                                 │   │  • Block            │   │
                                                 │   │  • Warn             │   │
                                                 │   │  • Log              │   │
                                                 │   │  • Notify           │   │
                                                 │   │  • RequireApproval  │   │
                                                 │   │  • RateLimit        │   │
                                                 │   │  • Redact           │   │
                                                 │   │  • Audit            │   │
                                                 │   │  • Transform        │   │
                                                 │   │  • Webhook          │   │
                                                 │   │  • Custom           │   │
                                                 │   └─────────────────────┘   │
                                                 └─────────────────────────────┘
```

---

## 5. Memory System Architecture (Phase 6)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                      SEMANTIC MEMORY SYSTEM (Phase 6)                            │
└─────────────────────────────────────────────────────────────────────────────────┘

                              ┌──────────────┐
                              │    Input     │
                              │  (Query/     │
                              │   Content)   │
                              └──────┬───────┘
                                     │
                                     ▼
                    ┌────────────────────────────────┐
                    │       Embedding Generation     │
                    │  (OpenAI / Local / Anthropic)  │
                    └────────────────┬───────────────┘
                                     │
                                     ▼
                    ┌────────────────────────────────┐
                    │        Memory Manager          │
                    └────────────────┬───────────────┘
                                     │
        ┌────────────────────────────┼────────────────────────────┐
        │                            │                            │
        ▼                            ▼                            ▼
┌───────────────────┐    ┌───────────────────┐    ┌───────────────────┐
│   Working Memory  │    │  Episodic Memory  │    │  Semantic Memory  │
│                   │    │                   │    │                   │
│  • Current context│    │  • Conversations  │    │  • Facts          │
│  • Short-term     │    │  • Sessions       │    │  • Knowledge      │
│  • Fast access    │    │  • Events         │    │  • Long-term      │
│                   │    │  • Time-indexed   │    │  • Slow decay     │
└─────────┬─────────┘    └─────────┬─────────┘    └─────────┬─────────┘
          │                        │                        │
          │                        │                        │
          └────────────────────────┼────────────────────────┘
                                   │
                                   ▼
                    ┌────────────────────────────────┐
                    │    Memory Consolidation        │
                    │                                │
                    │  • Working → Episodic          │
                    │  • Episodic → Semantic         │
                    │  • Importance scoring          │
                    │  • Decay application           │
                    └────────────────┬───────────────┘
                                     │
                                     ▼
                    ┌────────────────────────────────┐
                    │       Vector Storage           │
                    │                                │
                    │  ┌──────────────────────────┐ │
                    │  │     Backends:            │ │
                    │  │  • In-Memory (dev)       │ │
                    │  │  • SQLite (local)        │ │
                    │  │  • Qdrant (production)   │ │
                    │  │  • Pinecone (cloud)      │ │
                    │  └──────────────────────────┘ │
                    └────────────────────────────────┘
```

---

## 6. Enterprise Dashboard Architecture (Phase 7)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                      ENTERPRISE DASHBOARD (Phase 7)                              │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              FRONTEND (React)                                    │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                           Navigation Bar                                    │ │
│  │   [Dashboard] [Sessions] [Analytics] [Policies] [Settings] [Profile]       │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
│  ┌─────────────────────────────────┬────────────────────────────────────────┐  │
│  │         Summary Cards           │           Activity Feed                 │  │
│  │  ┌───────┐ ┌───────┐ ┌───────┐ │  ┌────────────────────────────────────┐│  │
│  │  │Active │ │ Tool  │ │Tokens │ │  │ • User X started session           ││  │
│  │  │Sessions│ │ Calls │ │ Used  │ │  │ • Tool Y executed                  ││  │
│  │  │  12   │ │ 1,234 │ │ 50K   │ │  │ • Guardrail blocked attempt        ││  │
│  │  └───────┘ └───────┘ └───────┘ │  │ • Policy rule triggered            ││  │
│  └─────────────────────────────────┴────────────────────────────────────────┘  │
│                                                                                  │
│  ┌─────────────────────────────────┬────────────────────────────────────────┐  │
│  │        Usage Charts             │          Cost Breakdown                 │  │
│  │  ┌───────────────────────────┐ │  ┌────────────────────────────────────┐│  │
│  │  │     ╭─────────────╮      │ │  │         Donut Chart               ││  │
│  │  │    ╱              ╲     │ │  │     ┌─────┐                        ││  │
│  │  │   ╱                ╲    │ │  │     │     │ Claude: $45           ││  │
│  │  │  ╱                  ╲   │ │  │     │     │ GPT-4: $30            ││  │
│  │  │ ╱                    ╲  │ │  │     └─────┘ Other: $10            ││  │
│  │  └───────────────────────────┘ │  └────────────────────────────────────┘│  │
│  └─────────────────────────────────┴────────────────────────────────────────┘  │
│                                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────────┐  │
│  │                      Active Sessions Table                                │  │
│  │  ┌──────────┬─────────────┬──────────┬────────┬─────────────────────────┐│  │
│  │  │   User   │   Started   │ Messages │ Status │        Actions          ││  │
│  │  ├──────────┼─────────────┼──────────┼────────┼─────────────────────────┤│  │
│  │  │ Alice    │ 10:32 AM    │    15    │ Active │ [View] [Replay] [Stop]  ││  │
│  │  │ Bob      │ 10:15 AM    │    42    │ Idle   │ [View] [Replay] [Stop]  ││  │
│  │  │ Carol    │ 09:45 AM    │    8     │ Error  │ [View] [Replay] [Stop]  ││  │
│  │  └──────────┴─────────────┴──────────┴────────┴─────────────────────────┘│  │
│  └──────────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────────┘
                                     │
                                     │ REST API / WebSocket
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              BACKEND (Rust)                                      │
│                                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────────┐  │
│  │                           API Router (Axum)                               │  │
│  │                                                                           │  │
│  │  /api/sessions     → Session management                                   │  │
│  │  /api/analytics    → Usage statistics, costs, performance                 │  │
│  │  /api/workspaces   → Workspace CRUD, members                             │  │
│  │  /api/guardrails   → Configuration, detection logs                        │  │
│  │  /api/policies     → Rule management                                      │  │
│  │  /api/users        → User management, permissions                         │  │
│  │  /ws               → Real-time updates                                    │  │
│  └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
│  ┌─────────────────┬──────────────────┬─────────────────┬──────────────────┐   │
│  │   Auth Service  │  Analytics Svc   │  Session Store  │   Event Stream   │   │
│  │  (JWT/OAuth)    │  (Aggregation)   │  (PostgreSQL)   │   (Broadcast)    │   │
│  └─────────────────┴──────────────────┴─────────────────┴──────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 7. Cloud-Native Deployment Architecture (Phase 7)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    KUBERNETES DEPLOYMENT ARCHITECTURE                            │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              KUBERNETES CLUSTER                                  │
│                                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────────┐  │
│  │                              INGRESS                                      │  │
│  │   ┌─────────────────────────────────────────────────────────────────┐    │  │
│  │   │  goose.example.com  →  nginx-ingress  →  TLS Termination       │    │  │
│  │   └─────────────────────────────────────────────────────────────────┘    │  │
│  └──────────────────────────────────────────────────────────────────────────┘  │
│                                     │                                           │
│  ┌──────────────────────────────────┼───────────────────────────────────────┐  │
│  │                          SERVICE MESH                                     │  │
│  │                                  │                                        │  │
│  │  ┌───────────────────────────────┼───────────────────────────────────┐   │  │
│  │  │                        GOOSE NAMESPACE                             │   │  │
│  │  │                               │                                    │   │  │
│  │  │  ┌─────────────────────────────────────────────────────────────┐  │   │  │
│  │  │  │              GOOSE AGENT DEPLOYMENT                          │  │   │  │
│  │  │  │                                                              │  │   │  │
│  │  │  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │  │   │  │
│  │  │  │  │ Pod 1   │  │ Pod 2   │  │ Pod 3   │  │ Pod N   │        │  │   │  │
│  │  │  │  │         │  │         │  │         │  │         │        │  │   │  │
│  │  │  │  │ Agent   │  │ Agent   │  │ Agent   │  │ Agent   │        │  │   │  │
│  │  │  │  │         │  │         │  │         │  │         │        │  │   │  │
│  │  │  │  │ :8080   │  │ :8080   │  │ :8080   │  │ :8080   │        │  │   │  │
│  │  │  │  │ :9000   │  │ :9000   │  │ :9000   │  │ :9000   │        │  │   │  │
│  │  │  │  │ :9090   │  │ :9090   │  │ :9090   │  │ :9090   │        │  │   │  │
│  │  │  │  └─────────┘  └─────────┘  └─────────┘  └─────────┘        │  │   │  │
│  │  │  │                           │                                  │  │   │  │
│  │  │  │  ┌────────────────────────┴────────────────────────────┐   │  │   │  │
│  │  │  │  │           Horizontal Pod Autoscaler                  │   │  │   │  │
│  │  │  │  │  Min: 3  |  Max: 50  |  Target CPU: 70%              │   │  │   │  │
│  │  │  │  └─────────────────────────────────────────────────────┘   │  │   │  │
│  │  │  └──────────────────────────────────────────────────────────────┘  │   │  │
│  │  │                                                                    │   │  │
│  │  │  ┌─────────────────────────────────────────────────────────────┐  │   │  │
│  │  │  │              SUPPORTING SERVICES                             │  │   │  │
│  │  │  │                                                              │  │   │  │
│  │  │  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │  │   │  │
│  │  │  │  │  PostgreSQL  │  │    Redis     │  │    Qdrant    │       │  │   │  │
│  │  │  │  │  (Sessions)  │  │   (Cache)    │  │  (Vectors)   │       │  │   │  │
│  │  │  │  │              │  │              │  │              │       │  │   │  │
│  │  │  │  │   Primary    │  │   Primary    │  │   Primary    │       │  │   │  │
│  │  │  │  │   +Replica   │  │              │  │              │       │  │   │  │
│  │  │  │  └──────────────┘  └──────────────┘  └──────────────┘       │  │   │  │
│  │  │  └──────────────────────────────────────────────────────────────┘  │   │  │
│  │  │                                                                    │   │  │
│  │  │  ┌─────────────────────────────────────────────────────────────┐  │   │  │
│  │  │  │              OBSERVABILITY STACK                             │  │   │  │
│  │  │  │                                                              │  │   │  │
│  │  │  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │  │   │  │
│  │  │  │  │  Prometheus  │  │   Grafana    │  │    Jaeger    │       │  │   │  │
│  │  │  │  │  (Metrics)   │  │ (Dashboards) │  │  (Tracing)   │       │  │   │  │
│  │  │  │  └──────────────┘  └──────────────┘  └──────────────┘       │  │   │  │
│  │  │  │                                                              │  │   │  │
│  │  │  │  ┌──────────────────────────────────────────────────────┐   │  │   │  │
│  │  │  │  │          OpenTelemetry Collector                      │   │  │   │  │
│  │  │  │  │   (Receives OTLP from all Goose pods)                 │   │  │   │  │
│  │  │  │  └──────────────────────────────────────────────────────┘   │  │   │  │
│  │  │  └──────────────────────────────────────────────────────────────┘  │   │  │
│  │  └────────────────────────────────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 8. Data Flow Summary

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           DATA FLOW OVERVIEW                                     │
└─────────────────────────────────────────────────────────────────────────────────┘

  User Request                          LLM Response
      │                                      ▲
      ▼                                      │
┌──────────┐                           ┌──────────┐
│  Input   │                           │  Output  │
│ Validate │                           │  Format  │
└────┬─────┘                           └────┬─────┘
     │                                      │
     ▼                                      │
┌──────────┐                           ┌────┴─────┐
│Guardrails│───── Blocked? ───────────►│  Error   │
│  Scan    │         │                 │ Response │
└────┬─────┘         │                 └──────────┘
     │               │
     │ Passed        │
     ▼               │
┌──────────┐         │
│ Policy   │───── Action? ────────────►│  Policy  │
│ Engine   │         │                 │ Response │
└────┬─────┘         │                 └──────────┘
     │               │
     │ Allowed       │
     ▼               │
┌──────────┐         │
│  Agent   │         │
│   Core   │         │
│          │         │
│ Planning │         │
│ Reasoning│         │
│ Tool Use │         │
└────┬─────┘         │
     │               │
     ▼               │
┌──────────┐         │
│   MCP    │         │
│ Gateway  │         │
│          │         │
│ Route    │         │
│ Execute  │         │
│ Audit    │         │
└────┬─────┘         │
     │               │
     ▼               │
┌──────────┐         │
│  LLM     │         │
│ Provider │         │
│          │         │
│ Claude   │         │
│ GPT-4    │         │
│ etc.     │         │
└────┬─────┘         │
     │               │
     │               │
     └───────────────┘

                     │
                     │ (Throughout)
                     ▼
              ┌──────────────┐
              │ Observability │
              │              │
              │  • Costs     │
              │  • Metrics   │
              │  • Traces    │
              │  • Logs      │
              └──────────────┘
```

---

**Document End**
