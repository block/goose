version: 1.0.0
title: Messy Column Fixer
author:
  contact: the-matrixneo 
description: "Fixes messy columns: normalizes and cleans CSV data."
instructions: |
  1. Provide the path to your CSV file.
  2. The recipe will scan all columns for type mismatches and missing values.
  3. It will suggest fixes (or automatically apply them, depending on your choice).
  4. Review the output and save your cleaned file.
activities:
  - Scan CSV columns for type mismatches.
  - Detect missing values and formatting problems.
  - Apply fixes for detected issues.
extensions:
  - type: stdio
    name: filesystem
    description: "Fixes messy columns in CSV files by normalizing and cleaning the data."
    cmd: npx
    args:
      - "-y"
      - "@modelcontextprotocol/server-filesystem"
      - "/path/to/allowed/directory"
    display_name: Filesystem
    timeout: 300
    bundled: false
prompts:
  main_prompt: |
    You are a Messy Column Fixer. Your job is to scan the provided CSV file and detect columns with:
      - Mixed or inconsistent data types.
      - Missing values.
      - Formatting issues (e.g., extra spaces, non-uniform capitalization).
    For each problem found, suggest a fix (or apply it if auto_fix is true), such as:
      - Convert all values to the most common type.
      - Fill missing values with a sensible default (e.g., mean, median, or "N/A").
      - Standardize formatting.
    Output a summary of problems detected, fixes applied, and provide the cleaned CSV.

  scan_prompt: |
    Scan the CSV file at {file_path} and analyze each column for:
    1. Data type consistency (check for mixed types in the same column)
    2. Missing values (count and percentage)
    3. Formatting issues (extra spaces, inconsistent capitalization, date formats, etc.)
    4. Statistical anomalies for numerical columns

    Return a detailed analysis of each column's issues.

  fix_prompt: |
    Based on the analysis, propose fixes for each problematic column:
    - For type mismatches: suggest converting to the most appropriate type
    - For missing values: suggest appropriate fill strategies (mean, median, mode, forward fill, or "N/A")
    - For formatting: suggest standardization rules

    If auto_fix is "true", apply these fixes. Otherwise, present them as suggestions.

  summary_prompt: |
    Create a comprehensive summary including:
    - Original file issues found
    - Fixes applied or suggested
    - Changes made to each column
    - Statistics before and after cleaning
    - Save the cleaned CSV file with "_cleaned" suffix

prompt_chain:
  - step: scan_analysis
    prompt_ref: scan_prompt
    output_filter: "Column analysis report"

  - step: fix_proposal
    prompt_ref: fix_prompt
    output_filter: "Proposed fixes"

  - step: apply_and_summarize
    prompt_ref: summary_prompt
    output_filter: "Cleaned CSV and summary of changes"

prompt: |
  I'll help you clean your CSV file using the Messy Column Fixer recipe.

  First, I'll scan your file at {file_path} to identify:
  - Mixed data types in columns
  - Missing values  
  - Formatting inconsistencies
  - Other data quality issues

  Then I'll {auto_fix_decision} for the detected issues.
  Finally, I'll provide a comprehensive summary and the cleaned dataset.
  Let me start by analyzing your CSV file.
